<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>I LOVE YOU PENG</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body {
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    background: #0a0a12;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  canvas { display: none; }
  #output {
    font-family: 'Courier New', monospace;
    white-space: pre;
    display: block;
    background: #0a0a12;
  }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="output"></div>
<script>
const img = new Image();
img.onload = function() { render(); };
img.src = '9d123f8f-22f8-4dff-9e79-749ec86a5265.jpg';
 
function render() {
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const output = document.getElementById('output');

  const screenW = window.innerWidth;
  const screenH = window.innerHeight;
  const isMobile = screenW <= 768 || ('ontouchstart' in window && screenW < screenH);

  const phrase = 'ILOVEYOUPENG';
  const imgNatW = img.naturalWidth;
  const imgNatH = img.naturalHeight;

  let html = '';

  if (isMobile) {
    const CHAR_ASPECT = 2.0;
    const fontSize = Math.max(5, Math.floor(screenW / 60));
    const charW = fontSize * 0.601;
    const charH = fontSize * CHAR_ASPECT * 0.5;
    const cols = Math.floor(screenW / charW);
    const rows = Math.floor(screenH / charH);

    const screenRatio = screenW / screenH;
    let cropW = imgNatW;
    let cropH = Math.round(imgNatW / screenRatio);
    if (cropH > imgNatH) {
      cropH = imgNatH;
      cropW = Math.round(imgNatH * screenRatio);
    }
    const cropX = Math.floor((imgNatW - cropW) / 2);
    const cropY = Math.floor((imgNatH - cropH) / 2);

    canvas.width = cols;
    canvas.height = rows;
    ctx.drawImage(img, cropX, cropY, cropW, cropH, 0, 0, cols, rows);
    const data = ctx.getImageData(0, 0, cols, rows).data;

    let idx = 0;
    for (let y = 0; y < rows; y++) {
      for (let x = 0; x < cols; x++) {
        const i = (y * cols + x) * 4;
        const r = data[i], g = data[i+1], b = data[i+2];
        const brightness = r * 0.299 + g * 0.587 + b * 0.114;
        const char = phrase[idx++ % phrase.length];
        const v = Math.round(brightness * 0.85);
        const rv = Math.round(v * 0.8);
        const gv = Math.round(v * 0.85);
        const bv = Math.min(255, Math.round(v * 1.1));
        html += '<span style="color:rgb(' + rv + ',' + gv + ',' + bv + ')">' + char + '</span>';
      }
      if (y < rows - 1) html += '\n';
    }

    output.style.fontSize = fontSize + 'px';
    output.style.lineHeight = charH + 'px';
    output.style.letterSpacing = ((screenW / cols) - fontSize * 0.601) + 'px';

  } else {
    const maxW = 140;
    const scale = maxW / imgNatW;
    const W = Math.floor(imgNatW * scale);
    const H = Math.floor(imgNatH * scale * 0.48);

    canvas.width = W;
    canvas.height = H;
    ctx.drawImage(img, 0, 0, W, H);
    const data = ctx.getImageData(0, 0, W, H).data;

    let idx = 0;
    for (let y = 0; y < H; y++) {
      for (let x = 0; x < W; x++) {
        const i = (y * W + x) * 4;
        const r = data[i], g = data[i+1], b = data[i+2];
        const brightness = r * 0.299 + g * 0.587 + b * 0.114;
        const char = phrase[idx++ % phrase.length];
        const v = Math.round(brightness * 0.85);
        const rv = Math.round(v * 0.8);
        const gv = Math.round(v * 0.85);
        const bv = Math.min(255, Math.round(v * 1.1));
        html += '<span style="color:rgb(' + rv + ',' + gv + ',' + bv + ')">' + char + '</span>';
      }
      html += '\n';
    }

    output.style.fontSize = '7px';
    output.style.lineHeight = '1.05';
    output.style.letterSpacing = '1px';
  }

  output.innerHTML = html;
}

window.addEventListener('resize', () => {
  document.getElementById('output').innerHTML = '';
  render();
});
</script>
</body>
</html>
